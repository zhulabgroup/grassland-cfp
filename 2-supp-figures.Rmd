---
title: "Supplementary figures"
date: "`r format(Sys.time(), '%B %d, %Y')`"
editor_options: 
  chunk_output_type: console
output:
  bookdown::html_document2: 
    fig_caption: true
    number_sections: true
    global_numbering: true
  bookdown::word_document2: 
    fig_caption: true
    number_sections: true
    global_numbering: true
---

```{r setup, echo=FALSE, message=FALSE}
source("scripts/utils/setup.R")
```

# Occurrence data sources

Compare BIEN, CCH, GBIF, iNat occurrence datasets.

```{r occ-data-tab}
source("scripts/compare-occ-data.R")
knitr::kable(occ_samp_tbl, caption = "Comparison of occurrence datasets.")
```

```{r occ-data-fig, fig.cap="Occurrence data comparison from multiple sources in study area"}
occ_comp_gg
rm(list = ls())
```

# Climate data sources

Compare CHELSA and PRISM climate data at GBIF occurrence locations, by making scatter plots with correlation.

```{r clim-data-fig, fig.cap="Climate data comparison from multiple sources shows high consistency in study area."}
source("scripts/compare-clim-data.R")
chelsa_prism_gg / chelsa_terraclim_gg
rm(list = ls())
```

# Climate variable correlations

TODO: different bioclim variables are highly correlated

# Climate niche summary statistics

The mean, median, upper, lower temp and precip for all species are highly correlated.

```{r tmp-niche-fig, fig.cap="Species temperature niche statistics are highly correlated"}
source("scripts/compare-niche-stat.R")
niche_tmp_gg
```

```{r ppt-niche-fig, fig.cap="Species precipitation niche statistics are highly correlated"}
niche_ppt_gg
rm(list = ls())
```

# Spatial thinning occurrence-climate records

```{r thin-tmp-fig, fig.cap="Species temperature niche statistics (Â°C)"}
source("scripts/compare-sp-thin.R")
thin_tmp_gg
```

```{r thin-ppt-fig, fig.cap="Species precipitation niche statistics (mm)"}
thin_ppt_gg
rm(list = ls())
```

# Individual species climate niches

Generate a single species per page and assembly into a multi-page plot. Left geo-space, right clim-space.

```{r}
source("scripts/plot-ind-spp.R")
```

Show two example species.

```{r cool-sp-fig, fig.cap="Example species *Danthonia californica*"}
niche_gg["Danthonia californica"]
```

```{r warm-sp-fig, fig.cap="Example species *Stipa pulchra*"}
niche_gg["Stipa pulchra"]
```

Print all species into a multi-page PDF.

```{r, eval=FALSE}
# runtime ~= 4 min
pdf("figures/species-climate-niche.pdf", width = 8, height = 8 * .618)
print(niche_gg)
dev.off()
```

The file can be viewed at this [link](https://zhulab.ucsc.edu/projects/grassland/figures/species-climate-niche.pdf)

```{r}
rm(list = ls())
```

# Site info

Experimental and observational site information in table and map. The map has grassland coverage. Land cover type data on 0.05 degree resolution maunually downloaded from https://lpdaac.usgs.gov/products/mcd12c1v006/.

```{r site-tab}
source("scripts/show-site-info.R")
knitr::kable(site_tbl)
```

```{r site-fig, fig.cap="Map of experimental and observational study sites"}
site_gg
rm(list = ls())
```

# Site climate change

TODO: get PRISM/CHELSA data on six sites and plot climate change; may compare with CTI and CPI changes
